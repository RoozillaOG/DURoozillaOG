{"slots":{"0":{"name":"sMetalWorks","type":{"events":[],"methods":[]}},"1":{"name":"sDataBank","type":{"events":[],"methods":[]}},"2":{"name":"CoreUnit","type":{"events":[],"methods":[]}},"3":{"name":"slot4","type":{"events":[],"methods":[]}},"4":{"name":"slot5","type":{"events":[],"methods":[]}},"5":{"name":"slot6","type":{"events":[],"methods":[]}},"6":{"name":"slot7","type":{"events":[],"methods":[]}},"7":{"name":"slot8","type":{"events":[],"methods":[]}},"8":{"name":"slot9","type":{"events":[],"methods":[]}},"9":{"name":"slot10","type":{"events":[],"methods":[]}},"-1":{"name":"unit","type":{"events":[],"methods":[]}},"-3":{"name":"player","type":{"events":[],"methods":[]}},"-2":{"name":"construct","type":{"events":[],"methods":[]}},"-4":{"name":"system","type":{"events":[],"methods":[]}},"-5":{"name":"library","type":{"events":[],"methods":[]}}},"handlers":[{"code":"\n--== start file ..\\Industry\\IndustryState.lua ==--\n\nif not IndustryState then\n  IndustryState = {\n   [1] = \"Stopped\",\n   [2] = \"Running\",\n   [3] = \"Missing Ingredient\",\n   [4] = \"Ouptut Full\",\n   [5] = \"No Output Container\",\n   [6] = \"Pending\",\n   [7] = \"Missing Schematic\"\n  }\nend\n\n--== end file ..\\Industry\\IndustryState.lua ==--\n\n--== start file ..\\Utils\\DUDebug.lua ==--\n\nif not DUDebug then\n  DUDebug = {}\n  DUDebug.__index = DUDebug\n    \n  gDebugPrint = true --export: Enable or Display Debug Printing\n\n  function DebugPrint(message)\n    if(gDebugPrint) then\n      system.print(message)\n    end\n  end\nend\n\n--== end file ..\\Utils\\DUDebug.lua ==--\n\n--== start file ..\\Industry\\IndustryData.lua ==--\n\nif not IndustryData then\n  IndustryData = {}\n  IndustryData.__index = IndustryData\n\n  function IndustryData()\n    local self = {\n      name = \"\",\n      status = \"\",\n      product = \"\",\n      notification = \"\"\n    }\n    \n    return self\n  end\nend\n\n--== end file ..\\Industry\\IndustryData.lua ==--\n\n--== start file ..\\Industry\\IndustryMonitor.lua ==--\n\n--==require \"../Utils/DUDebug.lua\"\n--==require \"./IndustryData.lua\"\n--==require \"./IndustryState.lua\"\n\nif not IndustryMonitor then\n  IndustryMonitor = {}\n  IndustryMonitor.__index = IndustryMonitor\n\n  function IndustryMonitor(name, industryUnit, dataBank)\n    local self = {\n      name = name,\n      industryUnit = industryUnit,\n      dataBank = dataBank\n    }\n        \n    function self.Update()\n      system.print(\"Metalworks: Update()\")\n      if(self.dataBank) then\n        system.print(\"Metalworks: Update() dataBank is not nil\")\n        local data = IndustryData()\n\n        local info = self.industryUnit.getInfo()\n        DebugPrint(self.name .. \": info: \" .. json.encode(info))\n\n        data.name = self.name\n        data.state = IndustryState[self.industryUnit.getState()]\n        if(data.state == \"running\") then\n          data.notification = DataCellStatusGood\n        elseif(data.state == \"stopped\") then\n          data.state = DataCellStatusNormal\n        else\n          data.state = DataCellStatusNormal\n        end\n\n        local outputs = self.industryUnit.getOutputs()\n        DebugPrint(\"Output: \" .. json.encode(system.getItem(outputs[1].id).displayName))\n        data.product = system.getItem(outputs[1].id).displayName\n\n        local jsonRow = json.encode(data)\n        DebugPrint(\"Industry.\" .. self.name .. \".info = \" .. jsonRow)\n        self.dataBank.setStringValue((\"Industry.\" .. self.name .. \".info\"), jsonRow)\n      end\n    end\n\n    return self\n  end\nend\n\n--== end file ..\\Industry\\IndustryMonitor.lua ==--\n\n\n--== start file .\\unit.onStart__.0.lua ==--\n\nlocal json = require(\"dkjson\")\n--==require \"../Industry/IndustryMonitor.lua\"\n\nmonitor = IndustryMonitor(\n    \"Metalworks\",\n    sMetalWorks,\n    sDataBank\n  )\n\nmonitor.Update()\n\nunit.setTimer(\"ContainerUpdate\", 31)\nunit.setTimer(\"IndustryUpdate\", 10)\n\n--== end file .\\unit.onStart__.0.lua ==--\n","filter":{"args":[],"signature":"onStart()","slotKey":"-1"},"key":"0"},{"code":"--== start file .\\unit.onTimer_tag_.1.lua ==--\n\n-- Industry Update --\n\n--== end file .\\unit.onTimer_tag_.1.lua ==--","filter":{"args":[{"value":"ContainerUpdate"}],"signature":"onTimer(tag)","slotKey":"-1"},"key":"1"},{"code":"--== start file .\\unit.onTimer_tag_.2.lua ==--\n\n-- Container Update --\nmonitor.Update()\n\n--== end file .\\unit.onTimer_tag_.2.lua ==--","filter":{"args":[{"value":"IndustryUpdate"}],"signature":"onTimer(tag)","slotKey":"-1"},"key":"2"}],"methods":[],"events":[]}
